print((lambda x,f=lambda x,p=lambda x,a:(lambda f:f(f,x,a))(lambda f,x,a:[[-1,x,-1]]if a==[]else[[x,*a[0][1:]],*a[1:]]if x<a[0][1]>0>a[0][0]else[[*a[0][:2],x],*a[1:]]if x>a[0][1]>0>a[0][2]else[a[0],*f(f,x,a[1:])]):(lambda f:(lambda x,y:[int(x),f(f,[*map(int,y.split(","))])])(*x.split(":")))(lambda f,x,a=[]:f(f,x[1:],p(x[0],a))if x else a):sum(i*x for i,[*_,x]in enumerate(sorted([[int("".join(str(r[1])for r in s[1])),[int("".join(""if x<0else str(x)for x in r))for r in s[1]],s[0]]for s in map(f,x)])[::-1],1)))(open(0)))
